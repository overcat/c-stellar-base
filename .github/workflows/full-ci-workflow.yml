name: tests

on: [ push, pull_request ]


jobs:
  unit_test:
    name: Unit tests
    runs-on: ubuntu-latest
    env:
      CTEST_OUTPUT_ON_FAILURE: 1

    steps:
      - name: Clone
        uses: actions/checkout@v2

      - name: Install dependancies
        run: |
          sudo apt-get update -y
          sudo apt-get install libcmocka-dev cmake -y

      - name: Test
        run: |
          cd full
          cmake -Btests/build -Htests/ && make -C tests/build/ && make -C tests/build test