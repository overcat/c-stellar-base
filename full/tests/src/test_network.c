#include <setjmp.h>
#include <stdarg.h>
#include <stddef.h>

#include "../../src/network.h"
#include <cmocka.h>

void test_network_id_public_network(void **state) {
  char expect_hash[] = {0x7a, 0xc3, 0x39, 0x97, 0x54, 0x4e, 0x31, 0x75,
                        0xd2, 0x66, 0xbd, 0x2,  0x24, 0x39, 0xb2, 0x2c,
                        0xdb, 0x16, 0x50, 0x8c, 0x1,  0x16, 0x3f, 0x26,
                        0xe5, 0xcb, 0x2a, 0x3e, 0x10, 0x45, 0xa9, 0x79};
  char hash[32];
  network_id(PUBLIC_NETWORK_PASSPHRASE, hash);
  assert_memory_equal(hash, expect_hash, 32);
}

void test_network_id_test_network(void **state) {
  char expect_hash[] = {0xce, 0xe0, 0x30, 0x2d, 0x59, 0x84, 0x4d, 0x32,
                        0xbd, 0xca, 0x91, 0x5c, 0x82, 0x3,  0xdd, 0x44,
                        0xb3, 0x3f, 0xbb, 0x7e, 0xdc, 0x19, 0x5,  0x1e,
                        0xa3, 0x7a, 0xbe, 0xdf, 0x28, 0xec, 0xd4, 0x72};
  char hash[32];
  network_id(TESTNET_NETWORK_PASSPHRASE, hash);
  assert_memory_equal(hash, expect_hash, 32);
}

int main() {
  const struct CMUnitTest tests[] = {
      cmocka_unit_test(test_network_id_public_network),
      cmocka_unit_test(test_network_id_test_network),
  };
  return cmocka_run_group_tests(tests, NULL, NULL);
}
